<Page
    x:Class="Celestial.Views.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:model="using:Celestial.Models"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    mc:Ignorable="d">

    <Page.Resources>
        <CommandBarFlyout x:Key="GalleryGridViewFlyout">
            <AppBarButton
                x:Name="GalleryGridViewFlyout_Download"
                Click="GalleryGridViewFlyout_Download_Click"
                Content="Download"
                Icon="Download"
                ToolTipService.ToolTip="Download" />
        </CommandBarFlyout>
        <MenuFlyout x:Key="ImageViewer_Flyout">
            <MenuFlyoutItem
                x:Name="ImageViewer_Flyout_Download"
                Click="DownloadImageUI_Click"
                Icon="Download"
                Text="Download">
                <MenuFlyoutItem.KeyboardAccelerators>
                    <KeyboardAccelerator Key="S" Modifiers="Control" />
                </MenuFlyoutItem.KeyboardAccelerators>
            </MenuFlyoutItem>
            <MenuFlyoutItem
                Click="ShareUI_Click"
                Icon="Share"
                Text="Share" />
            <MenuFlyoutSeparator />
            <MenuFlyoutItem
                x:Name="ImageViewer_Flyout_SetWallpaper"
                Click="SetWallpaperUI_Click"
                Icon="SetLockScreen"
                Text="Set as wallpaper" />
            <MenuFlyoutSeparator />
            <ToggleMenuFlyoutItem
                x:Name="ImageViewer_Flyout_ShowPanel"
                Click="ImageViewer_Flyout_ShowPanel_Click"
                Icon="Important"
                IsChecked="True"
                Text="Show Panel">
                <ToggleMenuFlyoutItem.KeyboardAccelerators>
                    <KeyboardAccelerator Key="M" Modifiers="Control" />
                </ToggleMenuFlyoutItem.KeyboardAccelerators>
            </ToggleMenuFlyoutItem>
        </MenuFlyout>
    </Page.Resources>

    <Grid>
        <Grid x:Name="GalleryGrid">
            <GridView
                x:Name="GalleryGrid_GridView"
                Padding="5,20,5,20"
                HorizontalAlignment="Center"
                IsItemClickEnabled="True"
                ItemClick="GalleryGrid_GridView_ItemClick"
                Loaded="GalleryGrid_GridView_Loaded"
                SelectionMode="None"
                ShowsScrollingPlaceholders="True">
                <GridView.Header>
                    <Grid x:Name="GalleryGrid_GridView_Header" Opacity="0">
                        <TextBlock
                            Padding="0,10,0,20"
                            FontSize="28"
                            FontStretch="Expanded"
                            FontWeight="SemiBold"
                            Text="Explore" />
                        <CalendarDatePicker
                            x:Name="CDP"
                            Width="200"
                            Margin="0,10,0,20"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            DateChanged="CDP_DateChanged"
                            PlaceholderText="search by date" />
                        <DropDownButton
                            HorizontalAlignment="Right"
                            AutomationProperties.Name="More"
                            Background="Transparent"
                            CornerRadius="6"
                            Style="{ThemeResource ButtonRevealStyle}"
                            ToolTipService.ToolTip="More">
                            <DropDownButton.Content>
                                <SymbolIcon Symbol="More" />
                            </DropDownButton.Content>
                            <DropDownButton.Flyout>
                                <MenuFlyout Placement="Bottom">
                                    <MenuFlyoutItem Click="GalleryGrid_AboutButton_Click" Text="About">
                                        <MenuFlyoutItem.KeyboardAccelerators>
                                            <KeyboardAccelerator Key="I" Modifiers="Control" />
                                        </MenuFlyoutItem.KeyboardAccelerators>
                                    </MenuFlyoutItem>
                                </MenuFlyout>
                            </DropDownButton.Flyout>
                        </DropDownButton>
                    </Grid>
                </GridView.Header>
                <GridView.ItemTemplate>
                    <DataTemplate x:DataType="model:Apod">
                        <Grid
                            Width="300"
                            Height="300"
                            Margin="4"
                            AutomationProperties.AccessibilityView="Raw"
                            AutomationProperties.Name="{x:Bind Title}"
                            CornerRadius="6"
                            DataContext="{x:Bind}">
                            <Image
                                x:Name="GalleryGridView_GridView_Image"
                                ContextFlyout="{StaticResource GalleryGridViewFlyout}"
                                PointerEntered="Image_PointerEntered"
                                PointerExited="Image_PointerExited"
                                Stretch="UniformToFill"
                                ToolTipService.ToolTip="{x:Bind Date}">
                                <Image.Source>
                                    <BitmapImage UriSource="{x:Bind Url}" />
                                </Image.Source>
                            </Image>
                            <Grid
                                Width="300"
                                Height="60"
                                VerticalAlignment="Bottom"
                                Background="{ThemeResource SystemControlAcrylicElementBrush}"
                                ToolTipService.ToolTip="{x:Bind Title}">
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    FontSize="12"
                                    Text="{x:Bind Title}"
                                    TextWrapping="Wrap" />
                            </Grid>
                        </Grid>
                    </DataTemplate>
                </GridView.ItemTemplate>
            </GridView>
        </Grid>

        <Grid
            x:Name="ImageGrid"
            x:Load="False"
            Visibility="Collapsed">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid Grid.RowSpan="2">
                    <Image
                        x:Name="ImageGrid_Image"
                        VerticalAlignment="Top"
                        ContextFlyout="{StaticResource ImageViewer_Flyout}"
                        Loaded="ImageGrid_Image_Loaded"
                        Stretch="UniformToFill" />
                    <Button
                        x:Name="ImageGrid_BackButton"
                        Width="42"
                        Height="42"
                        Margin="20,32,0,0"
                        VerticalAlignment="Top"
                        AccessKey="B"
                        AutomationProperties.Name="Back"
                        Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
                        Click="ImageGrid_BackButton_Click"
                        CornerRadius="8"
                        Opacity="0"
                        ToolTipService.ToolTip="Back">
                        <Button.Content>
                            <SymbolIcon Symbol="Back" />
                        </Button.Content>
                        <Button.KeyboardAccelerators>
                            <KeyboardAccelerator Key="Escape" />
                        </Button.KeyboardAccelerators>
                    </Button>
                </Grid>
                <Grid
                    x:Name="ImageGrid_InfoPanel"
                    Grid.Row="1"
                    Width="800"
                    Height="250"
                    Margin="0,0,0,20"
                    AutomationProperties.AccessibilityView="Content"
                    Background="{ThemeResource SystemControlAcrylicElementBrush}"
                    CornerRadius="16"
                    Opacity="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <StackPanel
                        x:Name="ImageGrid_InfoPanel_MainPanel"
                        Grid.Column="0"
                        Width="300"
                        Margin="20"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Orientation="Vertical">
                        <TextBlock
                            x:Name="TitleTextBlock"
                            HorizontalAlignment="Center"
                            FontSize="16"
                            FontWeight="Bold"
                            IsTextSelectionEnabled="True"
                            TextWrapping="Wrap" />
                        <TextBlock
                            x:Name="CopyrightTextBlock"
                            Margin="0,10,0,0"
                            HorizontalAlignment="Center"
                            FontSize="14"
                            FontStretch="Expanded"
                            FontWeight="SemiLight"
                            IsTextSelectionEnabled="True"
                            TextWrapping="Wrap" />
                        <StackPanel
                            x:Name="ActionsPanel"
                            Width="124"
                            Height="42"
                            Margin="0,20,0,0"
                            Background="Transparent"
                            CornerRadius="8"
                            Opacity="1"
                            Orientation="Horizontal">
                            <Button
                                x:Name="ActionPanel_DownloadImage"
                                Width="42"
                                Height="42"
                                AccessKey="D"
                                AutomationProperties.Name="Download image"
                                Background="Transparent"
                                Click="DownloadImageUI_Click"
                                CornerRadius="0"
                                ToolTipService.ToolTip="Download">
                                <Button.Content>
                                    <SymbolIcon Symbol="Download" />
                                </Button.Content>
                                <Button.KeyboardAccelerators>
                                    <KeyboardAccelerator Key="S" Modifiers="Control" />
                                </Button.KeyboardAccelerators>
                            </Button>
                            <Button
                                x:Name="ActionPanel_SetWallpaper"
                                Width="42"
                                Height="42"
                                AccessKey="W"
                                AutomationProperties.Name="Set as wallpaper"
                                Background="Transparent"
                                Click="SetWallpaperUI_Click"
                                CornerRadius="0"
                                ToolTipService.ToolTip="Set as wallpaper">
                                <Button.Content>
                                    <SymbolIcon Symbol="SetLockScreen" />
                                </Button.Content>
                            </Button>
                            <Button
                                Width="42"
                                Height="42"
                                AccessKey="S"
                                AutomationProperties.Name="Share image"
                                Background="Transparent"
                                Click="ShareUI_Click"
                                CornerRadius="0"
                                ToolTipService.ToolTip="Share">
                                <Button.Content>
                                    <SymbolIcon Symbol="Share" />
                                </Button.Content>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                    <ScrollViewer
                        x:Name="ImageGrid_InfoPanel_DetailsPanel"
                        Grid.Column="1"
                        MaxWidth="500"
                        HorizontalAlignment="Right"
                        VerticalScrollBarVisibility="Visible">
                        <TextBlock
                            x:Name="ExplanationTextBlock"
                            Margin="20"
                            VerticalAlignment="Center"
                            FontSize="14"
                            IsTextSelectionEnabled="True"
                            TextWrapping="Wrap" />
                    </ScrollViewer>
                </Grid>
            </Grid>
        </Grid>

        <Grid
            x:Name="SettingsGrid"
            x:Load="False"
            Background="{ThemeResource SystemControlAcrylicElementBrush}"
            Loaded="SettingsGrid_Loaded"
            Visibility="Collapsed">
            <Grid
                Width="400"
                Height="180"
                Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
                CornerRadius="8">
                <Button
                    Margin="20,10,10,20"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    AccessKey="C"
                    AutomationProperties.Name="Close"
                    Background="Transparent"
                    Click="SettingsGrid_BackButton_Click"
                    CornerRadius="2"
                    Style="{ThemeResource ButtonRevealStyle}"
                    ToolTipService.ToolTip="Close">
                    <Button.Content>
                        <SymbolIcon Symbol="Cancel" />
                    </Button.Content>
                    <Button.KeyboardAccelerators>
                        <KeyboardAccelerator Key="Escape" />
                    </Button.KeyboardAccelerators>
                </Button>
                <StackPanel Margin="20" Orientation="Vertical">
                    <TextBlock
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        FontSize="22"
                        FontWeight="Bold"
                        Text="About" />
                    <TextBlock
                        x:Name="SettingsGrid_AboutDescriptionText"
                        Margin="0,10,10,20"
                        IsTextSelectionEnabled="True"
                        TextWrapping="Wrap" />
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</Page>